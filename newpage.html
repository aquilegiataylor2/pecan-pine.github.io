<!DOCTYPE html>
<html>
<meta charset="UTF-8">

	<head>
    <script>
           var body;
    var bodyStyle;
    var bodyHeightString;
    var bodyWidthString;
    var  bodyHeight;
    var bodyWidth;
    var rectangle;
    // position = [top left, bottom left, bottom right, top right]
    var position = "top left";
    function style(e, prop){
        return window.getComputedStyle(e).getPropertyValue(prop);
    }
    function getTop(e){
        return style(e, "top");
    }
    function getHeight(e){
        return style(e, "height");
    }
    function getTopFloat(e){
        return parseFloat(getTop(e).slice(0,-2));
    }
    function getHeightFloat(e){
        return parseFloat(getHeight(e).slice(0,-2));
    }
    function getWidthFloat(e){
        return parseFloat(window.getComputedStyle(e).getPropertyValue("width").slice(0,-2));
    }
    function getLeftFloat(e){
        return parseFloat(window.getComputedStyle(e).getPropertyValue("left").slice(0,-2));
    }
    function getTopPercent(e){
        let body = document.getElementById("body");
        let bodyStyle = window.getComputedStyle(body);
        let pageHeightString = bodyStyle.getPropertyValue("height");
        let pageHeight = parseFloat(pageHeightString.slice(0,-2));
        
        let eStyle = window.getComputedStyle(e);
        let eTopString = eStyle.getPropertyValue("top");
        let eTop = parseFloat(eTopString.slice(0,-2));
        return (100 * eTop / pageHeight).toFixed(2);
    }
    function getLeftPercent(e){
        let body = document.getElementById("body");
        let bodyStyle = window.getComputedStyle(body);
        let pageWidthString = bodyStyle.getPropertyValue("width");
        let pageWidth = parseFloat(pageWidthString.slice(0,-2));
        
        let eStyle = window.getComputedStyle(e);
        let eLeftString = eStyle.getPropertyValue("left");
        let eLeft = parseFloat(eLeftString.slice(0,-2));
        return (100 * eLeft / pageWidth).toFixed(2);
    }
    function onload(){
            body = document.getElementById("body");
    bodyStyle = window.getComputedStyle(body);
    bodyHeightString = bodyStyle.getPropertyValue("height");
    bodyWidthString = bodyStyle.getPropertyValue("width");
    bodyHeight = parseFloat(bodyHeightString.slice(0,-2)).toFixed(2);
    bodyWidth = parseFloat(bodyWidthString.slice(0,-2)).toFixed(2);
    
    rectangle = document.getElementById("rectangle");
    rectangle.addEventListener("click", moveMe, false);
    
    }
    
    function moveMe(){
        alert(position);
        if (position == "top left"){
            keepFalling();
            position = "bottom left";
        }
        else if (position == "bottom left"){
            slideRight();
            position = "bottom right";
        }   
        
    }
    
    async function slideRight(){
        while(getLeftFloat(rectangle) < bodyWidth - 1 * getWidthFloat(rectangle)){
            rectangle.style.left = (getLeftFloat(rectangle) + 1).toString() + "px";
            await sleep(5);
        }
    }
    
    async function keepFalling(){
        const e = document.getElementById("rectangle");
        while(getTopFloat(e) < bodyHeight - 1.5 * getHeightFloat(e)){
            fall();
            await sleep(5);
        }
    }
    
    function fall(){
        const e = document.getElementById("rectangle");
        //alert((getTopPercent(e)).toString() + "%");
        e.style.top = (getTopFloat(e) + 1).toString() + "px";
    }
    
    
    
    function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

	</script>
	<link rel="stylesheet" type="text/css" href="newpage.css">
	<title>Pecan Pine New Homepage</title>
	</head>
	
<body id="body" onload="onload();">

<div id="rectangle"></div>
</body> 
</html>
